# マッチングサービス 実装仕様書

## 1. システム概要

本システムは個人ユーザーと法人ユーザーのマッチングを行う求人サービスです。個人ユーザーは希望条件やスキルを登録し、法人ユーザーは求人情報を登録します。システムは条件に基づいて最適なマッチングを提供し、マッチングが成立した場合はメッセージ交換機能を通じてコミュニケーションが可能です。

## 2. 認証・ユーザー管理

### 2.1 ユーザー登録 (`User` モデル)
- ユーザーID（`user_id`）: 必須、ユニーク
- パスワード（`password`）: 必須
- ユーザー種別（`user_type`）: 必須、「個人」または「法人」

### 2.2 認証フロー
- 未ログインユーザーはトップページのみアクセス可能
- ログイン後はユーザー種別に応じたダッシュボードにリダイレクト
- 個人ユーザーは `individual` 名前空間下のコントローラーにアクセス
- 法人ユーザーは `company` 名前空間下のコントローラーにアクセス

## 3. ユーザープロフィール

### 3.1 個人プロフィール (`IndividualProfile` モデル)
- ユーザーID（`user_id`）: 外部キー
- 希望年収（`desired_salary`）: 任意、万円単位
- スキル: `UserSkill` モデルを通じて関連付け
- 希望条件: 勤務地、雇用形態、勤務形態を関連モデルで管理

### 3.2 企業プロフィール (`CompanyProfile` モデル)
- ユーザーID（`user_id`）: 外部キー
- 会社名（`company_name`）: 必須
- Webサイト（`website_url`）: 任意
- 会社の説明（`description`）: 任意
- 求人: `Job` モデルを通じて関連付け

## 4. 求人管理機能

### 4.1 求人情報 (`Job` モデル)
- 企業プロフィールID（`company_profile_id`）: 外部キー
- タイトル（`title`）: 必須
- 業務内容（`description`）: 必須
- 雇用形態（`employment_type_id`）: 外部キー、必須
- 勤務形態（`work_style_id`）: 外部キー、必須
- 勤務地（`location_id`）: 外部キー、必須
- 最低年収（`salary_min`）: 万円単位、任意
- 法的情報（`legal_info`）: 任意

### 4.2 求人スキル要件 (`JobSkill` モデル)
- 求人ID（`job_id`）: 外部キー
- スキルID（`skill_id`）: 外部キー
- レベル（`level`）: 1-5の整数値

## 5. マスターデータ

### 5.1 スキルマスター (`Skill` モデル)
- 名称（`name`）: 必須

### 5.2 勤務地マスター (`Location` モデル)
- 名称（`name`）: 必須

### 5.3 雇用形態マスター (`EmploymentType` モデル)
- 名称（`name`）: 必須

### 5.4 勤務形態マスター (`WorkStyle` モデル)
- 名称（`name`）: 必須

## 6. マッチング機能

### 6.1 マッチングロジック
- 勤務地、雇用形態、勤務形態の基本条件が一致
- 最低年収が個人の希望年収以上（希望年収設定時）
- 求人が要求するスキルをすべて満たす（スキル要件設定時）

### 6.2 いいね機能 (`Like` モデル)
- 法人ユーザーが個人ユーザーにいいね: ユーザーIDと対象ユーザーIDの組み合わせで記録
- 個人ユーザーが求人にいいね: ユーザーIDと求人IDの組み合わせで記録
- 双方向のいいねでマッチング成立

## 7. メッセージ機能

### 7.1 会話 (`Conversation` モデル)
- ユーザーID（`user_id`）: 外部キー（法人ユーザー）
- 対象ユーザーID（`target_user_id`）: 外部キー（個人ユーザー）
- 求人ID（`job_id`）: 外部キー
- ステータス（`status`）: 会話の状態管理

### 7.2 メッセージ (`Message` モデル)
- 会話ID（`conversation_id`）: 外部キー
- 送信者ID（`sender_id`）: 外部キー
- 内容（`content`）: メッセージ本文
- 既読フラグ（`read`）: 既読状態の管理

### 7.3 メッセージ機能の制約
- マッチングが成立した場合のみメッセージの送受信が可能
- 各ユーザーはメッセージ一覧と個別会話画面にアクセス可能
- メッセージの既読状態を管理し、未読メッセージ数を表示

## 8. ユーザーインターフェース

### 8.1 共通レイアウト
- ナビゲーションバー: ログイン状態とユーザー種別に応じた表示切り替え
- フッター: 共通情報の表示

### 8.2 個人ユーザー向け画面
- プロフィール表示・編集画面
- 求人一覧・詳細表示画面
- メッセージ一覧・詳細画面

### 8.3 法人ユーザー向け画面
- 企業プロフィール表示・編集画面
- 求人管理（一覧・作成・編集・削除）画面
- 個人ユーザー一覧・詳細表示画面
- メッセージ一覧・詳細画面

## 9. その他の機能

### 9.1 通知機能
- 新規メッセージ受信時の未読通知
- マッチング成立時の通知

### 9.2 検索・フィルタリング機能
- 求人の検索・フィルタリング
- 個人ユーザーの検索・フィルタリング 